# BayeSyC: robust Bayesian modeling captures bidirectional synergistic potency in drug combinations

BayeSyC is a Bayesian framework for estimating synergistic efficacy
    and bidirectional synergistic potency, enabling interpretable and robust analysis
    of drug combinations. This package also provides functions for preprocessing 
    dose-response data and generating summaries and interactive visualizations of model fits.

## Features

- Data handling utilities for **dose-response** assay data
- Multiple model families:
  - **Two-drug combinations**: BayeSyC and SynBa models
  - **Single-drug**: Monophasic and biphasic logistic curve models
- Estimation of **synergistic efficacy** and **bidirectional synergistic potency**
- **Outlier handling** with **non-Gaussian likelihoods** (negative binomial, gamma)
- **Summaries** and **interactive visualizations** (`ggplot2`, `plotly`)


## Installation

Install from the package source directory or from GitHub:

```r
install.packages("remotes")
remotes::install_github("yasumasak/bayesyc")
```

This package requires a working CmdStan installation for model fitting with `cmdstanr`.


## Repository structure

- **`R/`**: Package R source code and user-facing functions. Defines the package API and utilities.
- **`man/`**: Rd documentation files auto-generated from `R/` source and roxygen comments. Consult these for function help pages.
- **`vignettes/`**: Runnable example scripts and analysis workflows in R Markdown (`.Rmd`). Run locally with `rmarkdown::render("vignettes/<name>.Rmd")` or open in RStudio. See [Examples](#examples) section for details.
- **`stan/`**: Stan model source files:
  - `stan/*.stan`: Models for assay data **with** high/low controls
  - `stan/no_HC_LC/*.stan`: Models for assay data **with neither high nor low controls**
  - `stan/model_subtypes/*.stan`: Benchmarking model variants
- **`input/`**: Example input TSV files used by vignettes
- **`figures/`**: Scripts and source files to generate figures for the submitted paper

## Examples

The vignette R Markdown files in `vignettes/` serve as example scripts and are typically runnable end-to-end (with required dependencies and CmdStan setup).

- **`analysis_combination.Rmd`**: Drug combination (synergy) analysis for patient or cell-line data. Fits BayeSyC models (`stan/bayesyc-i_nb.stan` for count data using negative binomial distribution, or `stan/bayesyc-i_gamma.stan` for fluorescence data such as CellTiter-Glo using gamma distribution) to estimate synergistic effects and generate predictions.

- **`analysis_simulated_data.Rmd`**: Analysis of simulated drug combination datasets generated by `simulate_count_double_data.R`. Uses Stan models in `stan/model_subtypes/*.stan`.

- **`analysis_ONeil_2016.Rmd`**: Reanalysis of the O'Neil et al. (2016) cancer cell-line dataset. Uses Stan models in `stan/no_HC_LC/*.stan` and requires downloading the [supplementary data](https://aacrjournals.org/mct/article/15/6/1155/92159/).

- **`analysis_single_drug.Rmd`**: Single-drug dose-response analysis. Fits monophasic (`stan/logistic4_nb.stan`) and biphasic (`stan/biphasic4_nb.stan`) logistic curves to estimate IC50 values.

- **`simulate_count_double_data.R`**: R script to generate synthetic count-based drug combination data with known parameters for validation and benchmarking.


## Documentation and help

- Function reference: check `man/` help pages (e.g., `?Fit_BayeSyC4`).
- Vignettes: step-by-step analysis workflows located in `vignettes/`.

## Contact and citation

If you use `bayesyc` in published work, please cite the package and any underlying model papers as appropriate.<br>
Please submit a GitHub issue with any questions or if you experience any issues/bugs.